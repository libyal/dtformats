name: ntfs_i30_index
type: format
description: NTFS $I30 index record that contains directory entries
urls: ["https://github.com/libyal/libfsntfs/blob/main/documentation/New%20Technologies%20File%20System%20(NTFS).asciidoc#index"]
metadata:
  authors: ['Juan Leaniz <juan.leaniz@gmail.com']
  year: 2021
---
name: byte
type: integer
attributes:
  format: unsigned
  size: 1
  units: bytes
---
name: uint16
type: integer
attributes:
  format: unsigned
  size: 2
  units: bytes
---
name: uint32
type: integer
attributes:
  format: unsigned
  size: 4
  units: bytes
---
name: wchar
type: character
attributes:
  size: 1
  units: bytes
---
name: wchar16
type: character
description: 16-bit wide character type
attributes:
  size: 2
  units: bytes
---
name: wchar32
type: character
description: 32-bit wide character type
attributes:
  size: 4
  units: bytes
---
name: int64
type: integer
description: 64-bit little-endian signed integer type
attributes:
  byte_order: little-endian
  format: signed
  size: 8
  units: bytes
---
name: uint64
type: integer
description: 64-bit little-endian unsigned integer type
attributes:
  byte_order: little-endian
  format: unsigned
  size: 8
  units: bytes
---
name: file_name_attribute
type: structure
attributes:
  byte_order: little-endian
members:
- name: parent_file_reference
  data_type: uint64
- name: creation_time
  data_type: uint64
- name: modification_time
  data_type: uint64
- name: entry_modification_time
  data_type: uint64
- name: access_time
  data_type: uint64
- name: allocated_file_size
  data_type: uint64
- name: file_size
  data_type: uint64
- name: file_attribute_flags
  data_type: uint32
- name: extended_data
  data_type: uint32
- name: name_size
  data_type: byte
- name: name_space
  data_type: byte
- name: filename
  type: string
  encoding: utf-16-le
  element_data_type: wchar16
  number_of_elements: file_name_attribute.name_size
  elements_terminator: "\x00\x00"
---
name: index_entry_header
type: structure
attributes:
  byte_order: little-endian
members:
- name: signature
  type: stream
  element_data_type: byte
  number_of_elements: 4
  value: "INDX"
- name: fixup_value_offset
  data_type: uint16
- name: num_fixup_values
  data_type: uint16
- name: logfile_sequence_number
  data_type: int64
- name: virtual_cluster_number
  data_type: int64
---
name: index_node_header
type: structure
attributes:
  byte_order: little-endian
members:
- name: index_values_offset
  data_type: uint32
- name: index_node_size
  data_type: uint32
- name: allocated_index_node_size
  data_type: uint32
- name: index_node_flags
  data_type: uint32
---
name: index_directory_entry
type: structure
attributes:
  byte_order: little-endian
members:
- name: entry_header
  data_type: index_entry_header
- name: node_header
  data_type: index_node_header
- name: values_offset
  type: stream
  element_data_type: byte
  number_of_elements: index_directory_entry.node_header.index_values_offset - 16
- name: file_reference
  data_type: uint64
- name: index_value_size
  data_type: uint16
- name: index_key_data_size
  data_type: uint16
- name: index_value_flags
  data_type: uint32
- name: index_key_data
  condition: index_directory_entry.index_key_data_size > 64
  data_type: file_name_attribute
